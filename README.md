# 使用技術
- Ruby 2.6.5
- Ruby on Rails 6.0.3
- Vue.js 2.6.14
- PostgreSQL 11.2
- Heroku
- Puma
- Docker/Docker-compose
- CircleCi CI/CD
- Bootstrap5
- RSpec(最下部にテスト一覧を載せております。)

# Metista
学生が学習参考書、問題集で躓いた所やわからない所を簡便に教師に質問することができるアプリケーションです。

学校全体で導入するアプリケーション、ということを想定し作成致しました。アプリ内で教職員側、生徒側と分かれています。

教職員は生徒が質問するであろう参考書、問題集(例えば高校数学なら"一対一対応の数学"や"やさしい理系数学"等)の登録編集、生徒情報の閲覧、登録編集、及びログイン情報の閲覧ができます。

生徒は教職員が予め登録しておいた書籍を選択し、質問することができます。

解決済みの質問は匿名で公開されますので、生徒側は過去の同じような質問を簡単に検索し解決でき、教職員側は生徒がどの本の、どの単元、問題が躓きやすいか把握できます。
つまりDB化されますので今後の学習、教育に役立てることができます。

(このアプリケーションを作成した理由は下部に記述しておりますのでお時間あれば目を通していただけると幸甚です。)

# URL、ログイン
### URL
ゲストアカウントをご利用できます。

ログインフィールドに初期値が入力されていますのでそのままログインしていただけます。

#### 教職員入り口はこちら

#### 生徒入り口はこちら

(ゲストアカウントは自身のアカウント情報及びパスワード変更機能は利用できないようになっています。)

### レイアウト、デザイン
レスポンシブデザインに対応しています。

ブレイクポイントは992px

教職員側はデスクトップ、ノートPC利用を想定しサイドメニュー、生徒側はスマホ利用を想定しフッターメニューが表示されます。

学校導入を前提としていますので簡素なデザインでまとめました。


### CircleCi CI/CD
- GitHubへのpush時にbuild及びtestが実行されます。
- Masterブランチへマージした際にbuild及びtestが成功した場合、herokuへの自動デプロイが実行されます。

## どうしてこのアプリを作ったのか、プログラミングを勉強したのか
### 医学部再受験
2016/4~2019/3まで医師を志し、国公立医学部の再受験をしていました。
2016~2018年は予備校も無い田舎の地元に戻り、独学で勉強していました。周りに同じ志を持つ人は勿論おらず、SNSでモチベーションを維持しつつ勉学に励んでいました。
ですが、分からず詰まったところがあっても気軽に質問し解決する場がありませんでした。(質問掲示板等はあったのですが、質問内容から逸脱した回答が多かったりし、非常に解決に時間がかかるなど難儀していました。)
最終的にはセンター試験87%をとり、地方国公立医学部のボーダーラインは超えたのですが、二次試験を通過できず、最終的に諦めることとなりました。
### 私の中高校の話
一方、私の通った北嶺中高は非常に手厚い学習支援を行っていました。
進学校の私立中高にしては偏差値は高くないのですが、120名中、30-40人が東大及び国公立医学部に進学します。これは一重に先生方がご指導に尽力した結果だと今振り返って思います。
私は中高6年間、あまり勤勉な学生ではなかったのですが受験期に先生達の御支援で明治大学に合格致しました。(そこから浪人して上の大学を受験しましたが、最終的に明治大学に進学する運びとなりました。)

### 上記を踏まえて
私は予備校も無い、誰かに質問することもできない、同じ志を持つ人が側にいない田舎、一方で質問すればすぐ答えてくれる同志や先生達がいる都市部の学校、両方での受験を経験いたしました。

多くの人は受験期間か限られています。浪人が許されない人、一浪以上は許されない人、私のように〇〇年やったら諦めよう、という人。
限られた期間で早く実力をつけるには本人の努力以外にも成長しやすい環境も必要かと思います。

少しでも、なりたい自分になれる人が増えるよう、このアプリを作成致しました。


# 機能一覧
### 教職員
- ログイン機能(BCryptによるパスワードのハッシュ化、60分未アクセスでの自動ログアウト)
- お知らせ掲示板の閲覧、投稿、編集、削除機能(kaminari、フォームオブジェクトの作成)
- 生徒情報及び生徒住所の閲覧、新規登録、編集、削除、検索機能(STI、kaminari、検索ワードの正規化(module化)、リレーションオブジェクトによる検索、フォームオブジェクトの作成)
- 生徒ログイン情報の閲覧機能
- 参考書、問題集の新規登録、編集、検索機能(kaminari、正規化(module化)、リレーションオブジェクトによる検索、フォームオブジェクトの作成)
- 生徒からの質問への回答機能
- 自身のアカウント情報表示、パスワード変更機能
### 生徒
- ログイン機能(BCryptによるパスワードのハッシュ化、次回以降自動ログイン機能)
- 質問したい参考書、問題集の検索機能(kaminari、検索ワードの正規化、リレーションオブジェクトによる検索、フォームオブジェクトの作成)
- 質問の投稿、回答受付終了機能(フォームオブジェクトの作成、投稿内容の正規化)
- 質問へのコメント機能(投稿内容の正規化)
- 自身のアカウント情報表示

# ER図
![metista_er](https://user-images.githubusercontent.com/55440063/142962907-4b9bef4b-9d98-4885-8269-8f7744e6a24a.png)


# テストコード(Rspec)
## spec/model
### student_member_spec.rb
- 文字列を与えるとhashed_passwordは長さ60の文字列になる
- nilを与えると、hashed_passwordはnilになる
- stundent_numberの前後の空白を除去
- stundent_numberの全角数字を半角文字に変換
- family_name_kanaに含まれる平仮名をカタカナに変換
- family_name_kanaに含まれる半角カナを全角カナに変換
- emergency_contactの前後の空白を除去
- emergency_contactの全角数字を半角文字に変換
- email前後の空白を除去
- emailに含まれる全角英数字を半角英数字に変換
- email前後の全角英数字を除去
- family_name_kanaに漢字が含まれていた場合無効
- family_name_kanaに長音符が含まれていても有効
- family_nameに英字が含まれていても有効
- family_nameに記号が含まれていると無効
- family_name_kanaに長音符が含まれていても有効
- birth_dayには未来の日付は設定できない
- @を2個含むemailは無効
- 他のstudentとemailが重複している場合は無効
- 他のstudentとstudent_numberが重複している場合は無効
### teacher_member_spec.rb
- 文字列を与えるとhashed_passwordは長さ60の文字列になる
- nilを与えると、hashed_passwordはnilになる
- family_name_kanaに含まれる平仮名をカタカナに変換
- family_name_kanaに含まれる半角カナを全角カナに変換
- email前後の空白を除去
- emailに含まれる全角英数字を半角英数字に変換
- email前後の全角英数字を除去
- family_name_kanaに漢字が含まれていた場合無効
- family_name_kanaに長音符が含まれていても有効
- family_nameに英字が含まれていても有効
- family_nameに記号が含まれていると無効
- family_name_kanaに長音符が含まれていても有効
- birth_dayには未来の日付は設定できない
- @を2個含むemailは無効
- 他のteacherとemailが重複している場合は無効
### book_spec.rb
- book_nameに含まれる前後の空白を除去
- book_nameに含まれる半角カナを全角カナに変換
- book_nameに含まれる全角数字を半角文字に変換
- book_nameが空欄の場合無効
- book_subjectが空欄の場合無効
- book_typeが空欄の場合無効
### question_spec.rb
- titleに含まれる前後の空白を除去
- titleに含まれる半角カナを全角カナに変換
- titleに含まれる全角数字を半角文字に変換
- bodyに含まれる前後の空白を除去
- bodyに含まれる半角カナを全角カナに変換
- bodyに含まれる全角数字を半角文字に変換
- titleが空欄の場合無効
- bodyが空欄の場合無効
### answer_spec.rb
- bodyに含まれる前後の空白を除去
- bodyに含まれる半角カナを全角カナに変換
- bodyに含まれる全角数字を半角文字に変換
- bodyが空欄の場合無効
### board_message_spec.rb
- subjectに含まれる前後の空白を除去
- subjectに含まれる半角カナを全角カナに変換
- subjectに含まれる全角数字を半角文字に変換
- bodyに含まれる前後の空白を除去
- bodyに含まれる半角カナを全角カナに変換
- bodyに含まれる全角数字を半角文字に変換
- subjectが空欄の場合無効
- bodyが空欄の場合無効
## spec/features (Capybara) 
### student/question_spec.rb
- 生徒が質問する書籍を検索する
- 生徒が質問を投稿する
- 質問の際、タイトルは空欄にできない。(バリデーションエラーメッセージテスト)
- 質問の際、タイトルと本文両方空欄にはできない。(バリデーションエラーメッセージ同時表示のテスト)
### teacher/board_message_spec.rb
- 教職員が掲示板投稿機能を用い、題名、本文、タグ付けをし確認画面に遷移し、投稿する
- 題名を空欄にすると投稿できない(バリデーションエラーメッセージ表示テスト)
- 複数の項目を空欄にすると、複数のバリデーションエラーメッセージが表示される
- 教職員が投稿済みの内容を編集する
- 教職員が投稿済みの内容を空白にすると編集投稿できない
### teacher/book_spec.rb
- 教職員が書籍登録をする
- 書籍登録の際、書籍名は空欄にできない(バリデーション及びそのメッセージ表示テスト)
- 書籍登録の際、複数の項目を空欄にすると、複数のバリデーションエラーメッセージが同時に表示される。
### teacher/student_member_management_spec.rb
- 教職員が生徒情報、住所を新規登録する
- 教職員が生徒情報、住所を更新する
- 教職員が生徒情報、住所を更新する際、student_memberに適切な値、student_member.home_addressに不適切な値を入れた場合、両方とも更新されない
- 教職員がfamily_name_kanaを用いて生徒情報を検索する。
- 教職員が電話番号を用いて生徒情報を検索する。電話番号フォームからtelephone_number,emergency_contactどちらのカラムも検索することができる。本テストはtelephone_numberから
- 教職員が電話番号を用いて生徒情報を検索する。電話番号フォームからtelephone_number,emergency_contactどちらのカラムも検索することができる。本テストはemergency_contactから"
- 教職員がハイフン入りの電話番号を用いて生徒情報を検索する。(正規化のテスト)
## spec/request
### student/auto_login_spec.rb
- チェックボックスをオフにした場合
- チェックボックスをオンにした場合
### teacher/my_account_management_spec.rb
- 自身の情報表示
- 停止フラグがセットされたら強制的にログアウト
- セッションタイムアウト
- emailを変更する
- end_dateの書き換えは不可
### teacher/student_member_management_spec.rb
- 生徒の新規登録後、生徒一覧にリダイレクト
- 生徒にsuspendedフラグをセットする
- hashed_passwordの書き換え不可
## spec/services
### student/authenticator_spec.rb
- 正しいパスワードならtrueを返す
- 誤ったパスワードならfalseを返す
- パスワードが未設定ならfalseを返す
- 停止フラグが立っていればfalseを返す
- 入学日が明日ならfalseを返す
- 卒業日を過ぎているならfalseを返す
### teacher/authenticator_spec.rb
- 正しいパスワードならtrueを返す
- 誤ったパスワードならfalseを返す
- パスワードが未設定ならfalseを返す
- 停止フラグが立っていればfalseを返す
- 入職日が明日ならfalseを返す
- 退職日を過ぎているならfalseを返す
